import numpy as np
import scipy.stats as stats

"""
1-4 –∑–∞–¥–∞—á–∏ —Ä–µ—à–∞—Ç—å —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–π, 5—é –≤—Ä—É—á–Ω—É—é
–í—ã–±—Ä–∞—Ç—å —Ç–µ—Å—Ç –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å  –ª–∏ —Ä–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É –≤—ã–±–æ—Ä–∫–∞–º–∏:
"""

"""
–ó–∞–¥–∞–Ω–∏–µ-1:
–î–∞–Ω—ã –¥–≤–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –≤—ã–±–æ—Ä–∫–∏. –ù–µ —Å–æ–±–ª—é–¥–∞–µ—Ç—Å—è —É—Å–ª–æ–≤–∏–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏
x1: 380, 420, 290
y1: 140, 360, 200, 900
–°–¥–µ–ª–∞–π—Ç–µ –≤—ã–≤–æ–¥ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º, –ø–æ–ª—É—á–µ–Ω–Ω—ã–º —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏
"""

# –ü–æ—è—Å–Ω–µ–Ω–∏–µ:
# 1. –ù–µ —Å–æ–±–ª—é–¥–∞–µ—Ç—Å—è —É—Å–ª–æ–≤–∏–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ - –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏
# 2. –í—ã–±–æ—Ä–∫–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ, –≤—ã–±–æ—Ä–æ–∫ 2-–µ - –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —É—Å–ª–æ–≤–∏—è–º–∏ –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è
#     –∫—Ä–∏—Ç–µ—Ä–∏–µ–º –ú–∞–Ω–Ω–∞ - –£–∏—Ç–Ω–∏
# –ì–∏–ø–æ—Ç–µ–∑–∞-0 (ùêª_0): –ù–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã—Ö —Ä–∞–∑–ª–∏—á–∏–π –º–µ–∂–¥—É –≤—ã–±–æ—Ä–∫–∞–º–∏
# –ì–∏–ø–æ—Ç–µ–∑–∞-1 (ùêª_1): –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –∏–º–µ—é—Ç—Å—è
# ùêª_0: ùúá_1= ùúá_2
# ùêª_1: ùúá_1‚â† ùúá_2
# ùúá_1 –∏  ùúá_2‚àí –º–µ–¥–∏–∞–Ω—ã 1-–π –∏ 2-–π –≤—ã–±–æ—Ä–æ–∫.
#
# –û–±—ä–µ–¥–∏–Ω–∏–º –¥–∞–Ω–Ω—ã–µ –≤—ã–±–æ—Ä–æ–∫ –≤ –æ–¥–∏–Ω —Ä—è–¥ –∏ –ø—Ä–∏—Å–≤–æ–∏–º —Ä–∞–Ω–≥–∏:
# ---- X1 -----  ------ Y1 --------
# 380, 420, 290, 140, 360, 200, 900
#  5    6    3    1    4    2    7
# ∆© = 5+6+3 = 14  ∆© = 1+4+2+7 = 14
# –ò–º–µ–µ–º –≤ –≤–∏–¥—É —Å–ª–µ–¥—É—é—â–µ–µ:
# –ï—Å–ª–∏ —Å—É–º–º–∞ —Ä–∞–Ω–≥–æ–≤ –≤ –º–µ–Ω—å—à–µ–π –≤—ã–±–æ—Ä–∫–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏,
# –ø—Ä–∏—á–µ–º —Å–∞–º–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ —ç—Ç–æ—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª, —Ç–æ –≤–µ—Ä–Ω–∞ –Ω—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞

# –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤–æ–∑—å–º–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ Œ± = 0,05 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
# –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ —Ä–∞—Å—á–µ—Ç –≤—ã–ø–æ–ª–Ω–∏–º –∏—Å–ø–æ–ª—å–∑—É—è —Ñ—É–Ω–∫—Ü–∏—é mannwhitheyu() –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ stats:

hyp_0 = '–ù–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã—Ö —Ä–∞–∑–ª–∏—á–∏–π'
hyp_1 = '–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –∏–º–µ—é—Ç—Å—è'
alfa = 0.05                                       # Œ± = 0,05 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
X1 = np.array([380, 420, 290])
X2 = np.array([140, 360, 200, 900])

st, p_value = stats.mannwhitneyu(X1, X2, alternative='two-sided')
h0_true = p_value > alfa
p_val = round(p_value, 3)
compr_txt = f'{p_val} > {alfa}' if h0_true else f'{p_val} <= {alfa}'

# –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏
print()
print('–ó–∞–¥–∞–Ω–∏–µ-1.')
print('--------------------------------')
print(f'–ú–µ–∂–¥—É –≤—ã–±–æ—Ä–∫–∞–º–∏: '
      f'\n- X1 = {X1} '
      f'\n- Y1 = {X2}')
print(f'statistic = {st}; p_value = {p_val}')
print(f'{hyp_0 if h0_true else hyp_1}:')
print(f'—Ç.–∫. p_value {">" if h0_true else "<="} alfa ({compr_txt})')


"""
–ó–∞–¥–∞–Ω–∏–µ-2.
–ò—Å—Å–ª–µ–¥–æ–≤–∞–ª–æ—Å—å –≤–ª–∏—è–Ω–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞ –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –¥–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤. 
–°–Ω–∞—á–∞–ª–∞ –∏–∑–º–µ—Ä—è–ª–æ—Å—å –¥–∞–≤–ª–µ–Ω–∏–µ –¥–æ –ø—Ä–∏–µ–º–∞ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞, –ø–æ—Ç–æ–º —á–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç –∏ —á–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç. 
–ï—Å—Ç—å –ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–µ —Ä–∞–∑–ª–∏—á–∏—è?
1–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ –¥–æ –ø—Ä–∏–µ–º–∞ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞: 150, 160, 165, 145, 155
2–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç: 140, 155, 150,  130, 135
3–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç: 130, 130, 120, 130, 125
"""
# –ü–æ—è—Å–Ω–µ–Ω–∏–µ:
# 1. –ù–µ —Å–æ–±–ª—é–¥–∞–µ—Ç—Å—è —É—Å–ª–æ–≤–∏–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ - –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏
# 2. –ò–º–µ–µ–º –¥–µ–ª–æ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è–º–∏ –≤ —Ä–∞–º–∫–∞—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π
#    (–≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ —É—á–∞—Å—Ç–≤—É—é—Ç –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –ø–∞—Ü–∏–µ–Ω—Ç—ã)
#    –î–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —É—Å–ª–æ–≤–∏—è–º–∏ –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –∫—Ä–∏—Ç–µ—Ä–∏–µ–º –§—Ä–∏–¥–º–∞–Ω–∞
#
# –ü–∞—Ü–∏–µ–Ω—Ç	1-–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ     2-–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ     3-–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ
# 	        –∑–Ω–∞—á–µ–Ω–∏–µ    —Ä–∞–Ω–≥  –∑–Ω–∞—á–µ–Ω–∏–µ    —Ä–∞–Ω–≥	–∑–Ω–∞—á–µ–Ω–∏–µ    —Ä–∞–Ω–≥
# 1	        150	        3	  140	      2	    130	        1
# 2	        160	        3	  155	      2	    130	        1
# 3	        165	        3	  150	      2	    120	        1
# 4	        145	        3	  130	      1.5   130	        1.5
# 5	        155	        3	  135	      2	    125	        1
# 		              ‚àë = 15		    ‚àë = 9.5		      ‚àë = 5.5
#
# –ù–∞–π–¥–µ–º —Å—Ä–µ–¥–Ω–∏–π —Ä–∞–Ω–≥ R = n * (k+1)/2 = 5 * (3+1)/2 = 10, –≥–¥–µ n-–æ–±—ä–µ–º –≤—ã–±–æ—Ä–∫–∏ = 5, k-—á–∏—Å–ª–æ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º—ã—Ö –≥—Ä—É–ø–ø = 3
#
# –ö—Ä–∏—Ç–µ—Ä–∏–π –§—Ä–∏–¥–º–∞–Ω–∞ (—Ä–∞—Å—á–µ—Ç): œá_r^2 = 12 / (n*k*(k+1)) * ‚àë(R_i - R)^2 =
#                                     12 / (5*3*(3+1)) * [(15 - 10)^2 + (9.5 - 10)^2 + (5.5 - 10)^2] = 9.1

# –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤–æ–∑—å–º–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ Œ± = 0,05 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
# –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ —Ä–∞—Å—á–µ—Ç –≤—ã–ø–æ–ª–Ω–∏–º –∏—Å–ø–æ–ª—å–∑—É—è —Ñ—É–Ω–∫—Ü–∏—é friedmanchisquare() –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ stats:

measure_1 = np.array([150, 160, 165, 145, 155])
measure_2 = np.array([140, 155, 150,  130, 135])
measure_3 = np.array([130, 130, 120, 130, 125])

hyp_0 = '–ù–µ –∏–º–µ—é—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã—Ö —Ä–∞–∑–ª–∏—á–∏–π'
hyp_1 = '–ò–º–µ—é—Ç –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–µ —Ä–∞–∑–ª–∏—á–∏—è (–ø—Ä–µ–ø–∞—Ä–∞—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç)'
alfa = 0.05                                       # Œ± = 0,05 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

st, p_value = stats.friedmanchisquare(measure_1, measure_2, measure_3)
h0_true = p_value > alfa
p_val = round(p_value, 3)
compr_txt = f'{p_val} > {alfa}' if h0_true else f'{p_val} <= {alfa}'

# –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏
print()
print('–ó–∞–¥–∞–Ω–∏–µ-2.')
print('--------------------------------')
print(f'–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è: '
      f'\n- 1–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ –¥–æ –ø—Ä–∏–µ–º–∞ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞: {measure_1}'
      f'\n- –∏–∑–º–µ—Ä–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç: {measure_2}'
      f'\n- –∏–∑–º–µ—Ä–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç: {measure_3}'
      )
print(f'statistic = {st}; p_value = {p_val}')
print(f'{hyp_0 if h0_true else hyp_1}:')
print(f'—Ç.–∫. p_value {">" if h0_true else "<="} alfa ({compr_txt})')


"""
–ó–∞–¥–∞–Ω–∏–µ-3.
–°—Ä–∞–≤–Ω–∏—Ç–µ 1 –∏ 2-–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è –∏–∑ –ó–∞–¥–∞–Ω–∏—è-2, –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—è, —á—Ç–æ 3–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è —á–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç –Ω–µ –±—ã–ª–æ.
"""
# –ü–æ—è—Å–Ω–µ–Ω–∏–µ:
# 1. –ù–µ —Å–æ–±–ª—é–¥–∞–µ—Ç—Å—è —É—Å–ª–æ–≤–∏–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ - –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏
# 2. –ò–º–µ–µ–º –¥–µ–ª–æ —Å–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º 2-—Ö –∑–∞–≤–∏—Å–∏–º—ã—Ö –≤—ã–±–æ—Ä–æ–∫ –≤ —Ä–∞–º–∫–∞—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ—Å–ª–µ –ø—Ä–∏–Ω—è—Ç–∏—è –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞
#    (–≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ —É—á–∞—Å—Ç–≤—É—é—Ç –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –ø–∞—Ü–∏–µ–Ω—Ç—ã)
#    –î–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —É—Å–ª–æ–≤–∏—è–º–∏ –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –∫—Ä–∏—Ç–µ—Ä–∏–µ–º –£–∏–ª–∫–æ–∫—Å–æ–Ω–∞
#
#  3. –ù–∞—Ö–æ–¥–∏–º —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –ø–æ–∫–∞–∑–∞–Ω–∏—è–º–∏ –¥–æ –∏ –ø–æ—Å–ª–µ –ø—Ä–∏–µ–º–∞ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞ measure_2 - measure_1
measure_1 = np.array([150, 160, 165, 145, 155])
measure_2 = np.array([140, 155, 150,  130, 135])
measure_delta = measure_2 - measure_1

# 4. –°—É–¥—è –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É –≤—ã–±–æ—Ä–æ–∫, —É –Ω–∞—Å –Ω–µ—Ç –Ω–µ —Å–≤–æ–π—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (–≤—Å–µ —Ä–∞–∑–Ω–æ—Å—Ç–∏ < 0)
# –ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ —Ä–∞—Å—á–µ—Ç–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π –£–∏–ª–∫–æ–∫—Å–æ–Ω–∞, –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–ª–æ–∂–∏—Ç—å —Ä–∞–Ω–≥–∏
# –Ω–µ—Å–≤–æ–π—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –º–∞—Å—Å–∏–≤–∞ measure_2 - measure_1.
# –ù–æ –∏—Ö –Ω–µ—Ç. –û–∂–∏–¥–∞–µ–º–æ –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –∫—Ä–∏—Ç–µ—Ä–∏–π –£–∏–ª–∫–æ–∫—Å–æ–Ω–∞ –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω 0!
# –ü—Ä–æ–≤–µ—Ä–∏–º –Ω–∞—à–∏ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–µ–π –∏–∑ Python:
hyp_0 = '–ù–µ –∏–º–µ—é—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã—Ö —Ä–∞–∑–ª–∏—á–∏–π'
hyp_1 = '–ò–º–µ—é—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–µ —Ä–∞–∑–ª–∏—á–∏—è (–ø—Ä–µ–ø–∞—Ä–∞—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç)'
alfa = 0.05                                           # Œ± = 0,05 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
st, p_value = stats.wilcoxon(measure_1, measure_2, alternative='two-sided')

h0_true = p_value > alfa
p_val = round(p_value, 3)
compr_txt = f'{p_val} > {alfa}' if h0_true else f'{p_val} <= {alfa}'

# –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏
print()
print('–ó–∞–¥–∞–Ω–∏–µ-3.')
print('--------------------------------')
print(f'–ü–æ–∫–∞–∑–∞–Ω–∏—è –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –∏–∑–º–µ—Ä–µ–Ω–∏—è –¥–æ –∏ –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞ –æ—Ç –¥–∞–≤–ª–µ–Ω–∏—è: '
      f'\n- X1 = {measure_1} '
      f'\n- Y1 = {measure_2}')
print(f'statistic = {st}; p_value = {p_val}')
print(f'{hyp_0 if h0_true else hyp_1}:')
print(f'—Ç.–∫. p_value {">" if h0_true else "<="} alfa ({compr_txt})')


"""
–ó–∞–¥–∞–Ω–∏–µ-4.
–î–∞–Ω—ã 3 –≥—Ä—É–ø–ø—ã —É—á–µ–Ω–∏–∫–æ–≤ –ø–ª–∞–≤–∞–Ω–∏—è.
–í 1 –≥—Ä—É–ø–ø–µ –≤—Ä–µ–º—è –Ω–∞ –¥–∏—Å—Ç–∞–Ω—Ü–∏—é 50 –º —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç:
                  56, 60, 62, 55, 71, 67, 59, 58, 64, 67
–í—Ç–æ—Ä–∞—è –≥—Ä—É–ø–ø–∞ :   57, 58, 69, 48, 72, 70, 68, 71, 50, 53
–¢—Ä–µ—Ç—å—è –≥—Ä—É–ø–ø–∞:    57, 67, 49, 48, 47, 55, 66, 51, 54
"""
# –ü–æ—è—Å–Ω–µ–Ω–∏–µ:
# –ù–µ —Å–æ–±–ª—é–¥–∞–µ—Ç—Å—è —É—Å–ª–æ–≤–∏–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ - –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏.
# –ò–º–µ–µ–º –¥–µ–ª–æ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è–º–∏ –≤ —Ä–∞–º–∫–∞—Ö –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –≤—ã–±–æ—Ä–æ–∫
#    (–≤ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–∏ –ø–æ –ø–ª–∞–≤–∞–Ω–∏—é —É—á–∞—Å—Ç–≤—É—é—Ç –∑-–∏ –≥—Ä—É–ø–ø—ã —Å —Ä–∞–∑–Ω—ã–º–∏ —É—á–µ–Ω–∏–∫–∞–º–∏)
#    –î–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —É—Å–ª–æ–≤–∏—è–º–∏ –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –∫—Ä–∏—Ç–µ—Ä–∏–µ–º –ö—Ä—É—Å–∫–∞–ª–∞ - –£–æ–ª–ª–∏—Å–∞
#
# –ü–æ—Ä—è–¥–æ–∫ —Ä–∞—Å—á–µ—Ç—ã:
# 	1) –û–±–æ–±—â–∏–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ –æ–¥–∏–Ω —Ä—è–¥
# 	2) –ü—Ä–∏—Å–≤–æ–∏–º —Ä–∞–Ω–≥–∏ –≤ —ç—Ç–æ–º —Ä—è–¥—É
# 	3) –ü–æ—Å—á–∏—Ç–∞–µ–º —Å—É–º–º—É —Ä–∞–Ω–≥–æ–≤, –ø—Ä–∏—Å–≤–æ–µ–Ω–Ω—ã—Ö –≤ –æ–±—â–µ–º —Ä—è–¥—É, –Ω–æ —Ç–µ–ø–µ—Ä—å —É–∂–µ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –≥—Ä—É–ø–ø–∞—Ö.
#      –¢.–µ. –ø–æ–ª—É—á–∏–º —Å—É–º–º—É —Ä–∞–Ω–≥–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –æ—Ç–¥–µ–ª—å–Ω–æ–π –≥—Ä—É–ø–ø—ã.
# 	   –í–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è —Ñ–æ—Ä–º—É–ª–æ–π:
#      H = 12 / (N*(N+1)) * (‚àë (i = 1...k_j) T_j^2 / n_j) - 3*(N+1),
#      –≥–¥–µ N ‚Äì –æ–±—â–µ–µ —á–∏—Å–ª–æ –∏–∑–º–µ—Ä–µ–Ω–∏–π –≤–æ –≤—Å–µ—Ö —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º—ã—Ö –≤—ã–±–æ—Ä–∫–∞—Ö,
#      k_j - –æ–±—ä–µ–º j-–æ–π –≤—ã–±–æ—Ä–∫–∏
#      T_j - —Å—É–º–º–∞ —Ä–∞–Ω–≥–æ–≤ –≤ –∫–∞–∂–¥–æ–π –≤—ã–±–æ—Ä–∫–µ.

# –í—ã–ø–æ–ª–Ω–∏–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ —Ä–∞—Å—á–µ—Ç –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–≤—à–∏—Å—å —Ñ—É–Ω–∫—Ü–∏–µ–π kruskal() –≤ Python
gr_1 = np.array([56, 60, 62, 55, 71, 67, 59, 58, 64, 67])
gr_2 = np.array([57, 58, 69, 48, 72, 70, 68, 71, 50, 53])
gr_3 = np.array([57, 67, 49, 48, 47, 55, 66, 51, 54])

hyp_0 = '–ù–µ –∏–º–µ—é—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã—Ö —Ä–∞–∑–ª–∏—á–∏–π'
hyp_1 = '–ò–º–µ—é—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–µ —Ä–∞–∑–ª–∏—á–∏—è (–≤ —Å—Ä–µ–¥–Ω–µ–º –≤—ã—Å—Ç—É–ø–∏–ª–∏ –ø–æ —Ä–∞–∑–Ω–æ–º—É)'
alfa = 0.05                                       # Œ± = 0,05 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

st, p_value = stats.kruskal(gr_1, gr_2, gr_3)
h0_true = p_value > alfa
p_val = round(p_value, 3)
compr_txt = f'{p_val} > {alfa}' if h0_true else f'{p_val} <= {alfa}'

# –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏
print()
print('–ó–∞–¥–∞–Ω–∏–µ-4.')
print('--------------------------------')
print(f'–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–ø–ª—ã–≤–∞ –≤ 3-—Ö –≥—Ä—É–ø–ø–∞—Ö —É—á–µ–Ω–∏–∫–æ–≤: '
      f'\n- 1—è –≥—Ä—É–ø–ø–∞: {gr_1}'
      f'\n- 2—è –≥—Ä—É–ø–ø–∞: {gr_2}'
      f'\n- 3—è –≥—Ä—É–ø–ø–∞: {gr_3}'
      )
print(f'statistic = {st}; p_value = {p_val}')
print(f'{hyp_0 if h0_true else hyp_1}:')
print(f'—Ç.–∫. p_value {">" if h0_true else "<="} alfa ({compr_txt})')


"""
–ó–∞–¥–∞–Ω–∏–µ-5.
–ó–∞—è–≤–ª—è–µ—Ç—Å—è, —á—Ç–æ –ø–∞—Ä—Ç–∏—è –∏–∑–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å–æ —Å—Ä–µ–¥–Ω–∏–º –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–º 2,5 —Å–º. 
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—É—é –≥–∏–ø–æ—Ç–µ–∑—É, –µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ —Ä–∞–∑–º–µ—Ä—ã –∏–∑–¥–µ–ª–∏–π –ø–æ–¥—á–∏–Ω–µ–Ω—ã –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É –∑–∞–∫–æ–Ω—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è. 
–û–±—ä–µ–º –≤—ã–±–æ—Ä–∫–∏ 10, —É—Ä–æ–≤–µ–Ω—å —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ 5%
2.51, 2.35, 2.74, 2.56, 2.40, 2.36, 2.65, 2.7, 2.67, 2.34
"""
# –ü–æ—è—Å–Ω–µ–Ω–∏–µ:
# –ó–Ω–∞—á–µ–Ω–∏—è –≤ –≤—ã–±–æ—Ä–∫–µ –ø–æ —É—Å–ª–æ–≤–∏—é –∑–∞–¥–∞—á–∏ –ø–æ–¥—á–∏–Ω–µ–Ω—ã –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É –∑–∞–∫–æ–Ω—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.
# –î–∞–Ω–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ –Ω–µ –∏–∑–≤–µ—Å—Ç–Ω—ã, –ø–æ—ç—Ç–æ–º—É –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –∫—Ä–∏—Ç–µ—Ä–∏–µ–º –°—Ç—å—é–¥–µ–Ω—Ç–∞

# –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
m_0 = 2.5               # —Å–º.
alfa = 0.05             # %
n = 10                  # –æ–±—ä–µ–º –≤—ã–±–æ—Ä–∫–∏
a_sample = np.array([2.51, 2.35, 2.74, 2.56, 2.40, 2.36, 2.65, 2.7, 2.67, 2.34])

# –†–∞—Å—á–µ—Ç (–≤—Ä—É—á–Ω—É—é)
m_sample = np.mean(a_sample)
s_sample = np.std(a_sample, ddof=1)
d_sample = np.var(a_sample, ddof=1)             # s_sample**2 = d_sample
t = (m_sample - m_0) / np.sqrt(d_sample/n)      # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫—Ä–∏—Ç–µ—Ä–∏–π –°—Ç—å—é–¥–µ–Ω—Ç–∞, —Ç.–∫. –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –≥–µ–Ω. —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏
z_alfa_r = stats.t.ppf(alfa, (n-1))             # –∫–≤–∞–Ω—Ç–∏–ª—å –¥–ª—è –ø—Ä–∞–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
z_alfa_l = stats.t.ppf(1-alfa, (n-1))           # –∫–≤–∞–Ω—Ç–∏–ª—å –¥–ª—è –ª–µ–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

print()
print('–ó–∞–¥–∞–Ω–∏–µ-5.')
print('--------------------------------')
print(f'–°—Ä–µ–¥–Ω–µ–µ –ø–æ –≤—ã–±–æ—Ä–∫–µ –∏–∑ {n} –∑–∞–º–µ—Ä–æ–≤ –∏–∑–¥–µ–ª–∏—è: Mean = {m_sample}')
print(f'–°—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∏ –î–∏—Å–ø–µ—Ä—Å–∏—è –ø–æ –≤—ã–±–æ—Ä–∫–µ –∏–∑ {n} –∑–∞–º–µ—Ä–æ–≤: '
      f'sigma, D (sigma^2) = {s_sample, d_sample}')
print(f'–ö—Ä–∏—Ç–µ—Ä–∏–π –°—Ç—å—é–¥–µ–Ω—Ç–∞ - t = {t}')

print(f'–ì—Ä–∞–Ω–∏—Ü–∞ –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤ —á–∏—Å–ª–∞—Ö —Å–∏–≥–º –¥–ª—è –∫—Ä–∏—Ç–µ—Ä–∏—è Œ± = {round(alfa, 4)}:\n'
      f'- –ª–µ–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è—è z_a_left = {z_alfa_l}\n'
      f'- –ø—Ä–∞–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è—è z_a_right = {z_alfa_r}')

in_fiducia = (z_alfa_r < t if t > 0 else z_alfa_l > t)

print(f'–£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞—è–≤–∏—Ç–µ–ª—è, —á—Ç–æ –ø–∞—Ä—Ç–∏—è –∏–∑–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å–æ —Å—Ä–µ–¥–Ω–∏–º –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–º 2,5 —Å–º. '
      f'{"–í–ï–†–ù–û (z_alfa_r < t < z_alfa_l)" if in_fiducia else "–ù–ï –≤–µ—Ä–Ω–æ "}')


exit()
